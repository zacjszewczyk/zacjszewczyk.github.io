<!doctypehtml><html lang="en"><meta charset="UTF-8"><meta content="<html>"name="description"><meta content="Zac Szewczyk, Zachary Szewczyk, zacjszewczyk"name="keywords"><meta content="width=device-width,initial-scale=1"name="viewport"><meta content="Zac Szewczyk"name="application-name"><meta content="no-referrer"name="referrer"><meta content="#518341"name="theme-color"><meta content="index, follow"name="robots"><meta content="favicon.ico"property="og:image"><meta content="Building a Syllable Dictionary with Python - "property="og:title"><meta content="Zac J. Szewczyk"property="og:site_name"><meta content="Zac J. Szewczyk"property="og:article:author"><meta content="https://zacs.site/"property="og:see_also"><link href="/assets/manifest.json"rel="manifest"><link href="https://zacs.site/rss.xml"rel="alternate"type="application/rss+xml"title="RSS Feed for Zac J. Szewczyk's Blog"><link href="/assets/favicon.ico"rel="shortcut icon"type="image/ico"size="16x16"><link href="/assets/favicon_192.ico"rel="shortcut icon"type="image/ico"size="192x192"><link href="/assets/favicon_512.ico"rel="shortcut icon"type="image/ico"size="512x512"><title>Building a Syllable Dictionary with Python -  Zac J. Szewczyk</title><!-- SHEETS --><body id="post"style="opacity:.8;background-color:#f6f6f6;font-family:sans-serif;font-size:13pt;line-height:200%"><header style="text-align:center;font-size:150%;max-width:75em;margin:0 auto"><!--BLOCK HEADER--></header><nav style="display:grid;text-align:center;margin:10% 5%;font-size:15pt;line-height:200%"><a href="../index.html"id="home_link">Home</a> <a href="../blog.html"id="blog_link">Blog</a> <a href="../explore.html"id="explore_link">Explore</a> <a href="/rss.xml"id="rss_link">RSS</a> <a href="../archives.html"id="archives_link"rel="prefetch">Post Archives</a> <a href="../projects.html"id="projects_link">Projects</a> <a href="disclaimers.html"id="disclaimers_link">Disclaimers</a></nav><main style="max-width:65em;margin:0 auto;margin-bottom:100px"><section id="content_section">
<article>
                    <h2 style="text-align:center;">
                        <a href="building-a-syllable-dictionary-with-python.html" class="original">Building a Syllable Dictionary with Python</a>
                    </h2>
                    <time datetime="2019-10-04" pubdate="pubdate">By <link rel="author">Zac J. Szewczyk</link> on <a href="2019.html">2019</a>/<a href="2019-10.html">10</a>/04 19:19:07 EST</time>
<html>
<style type="text/css">
    .string { background-color: #fff0f0 }
    .keyword {color: #008800; font-weight: bold }
    .int { color: #0000DD; font-weight: bold }
    .comment { color: #888888 }
</style>

<p>As most projects do, this one started small. I already had a way to preview Markdown files. <a href="/projects.html#proofer">Proofer</a> also counts words, sentences, and paragraphs, then averages those values and estimates reading time. The script finds <a href="http://www.plainenglish.co.uk/the-a-z-of-alternative-words.html">complex or overused phrases</a>, and highlights repeated words, be verbs, and adverbs that make for weak writing, too. It also calculates the Gunning Fog Index, and scores for the Flesch-Kincaid reading ease and grade level tests. I built this script to give me a few more features than <a href="https://marked2app.com/">Marked</a>, which I had used to proof my writing for years. It worked well, but runtime shot up if it had to process posts with more than a few hundred words. I set out to fix this, and ended up building an entire syllable dictionary in Python. Proofer has still not gotten any faster.</p>

<p>Proofer had no trouble with small files, but runtime shot up if it had to process posts with more than a few hundred words. Runtime went up as word count did, and so I started hunting for performance wins in <a href="https://github.com/eaydin/sylco/blob/master/sylco.py">the 129-line method that counted syllables</a>. Called for every word in the source file but not optimized for speed or memory use, this seemed like a good place to start.</p>

<h3>The Original Syllable Counter</h3>

<p>Counting syllables seems easy. Spend some time looking for <a href="https://stackoverflow.com/questions/9096228/counting-syllables-in-a-word">examples</a> of <a href="https://stackoverflow.com/questions/46759492/syllable-count-in-python">others</a> doing <a href="http://shallowsky.com/blog/programming/count-syllables-in-python.html">this</a>, though, and you will soon realize that the English language makes this quite hard. I did not want to sink a ton of time into this, so I used this script from Emre Aydin.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span class="keyword">def</span> <span style="color: #0066BB; font-weight: bold">sylco</span>(word) :

    word <span style="color: #333333">=</span> word<span style="color: #333333">.</span>lower()

    <span class="comment"># exception_add are words that need extra syllables</span>
    <span class="comment"># exception_del are words that need less syllables</span>

    exception_add <span style="color: #333333">=</span> [<span class="string">&#39;serious&#39;</span>,<span class="string">&#39;crucial&#39;</span>]
    exception_del <span style="color: #333333">=</span> [<span class="string">&#39;fortunately&#39;</span>,<span class="string">&#39;unfortunately&#39;</span>]

    co_one <span style="color: #333333">=</span> [<span class="string">&#39;cool&#39;</span>,<span class="string">&#39;coach&#39;</span>,<span class="string">&#39;coat&#39;</span>,<span class="string">&#39;coal&#39;</span>,<span class="string">&#39;count&#39;</span>,<span class="string">&#39;coin&#39;</span>,<span class="string">&#39;coarse&#39;</span>,<span class="string">&#39;coup&#39;</span>,<span class="string">&#39;coif&#39;</span>,<span class="string">&#39;cook&#39;</span>,<span class="string">&#39;coign&#39;</span>,<span class="string">&#39;coiffe&#39;</span>,<span class="string">&#39;coof&#39;</span>,<span class="string">&#39;court&#39;</span>]
    co_two <span style="color: #333333">=</span> [<span class="string">&#39;coapt&#39;</span>,<span class="string">&#39;coed&#39;</span>,<span class="string">&#39;coinci&#39;</span>]

    pre_one <span style="color: #333333">=</span> [<span class="string">&#39;preach&#39;</span>]


    syls <span style="color: #333333">=</span> <span class="int">0</span> <span class="comment">#added syllable number</span>
    disc <span style="color: #333333">=</span> <span class="int">0</span> <span class="comment">#discarded syllable number</span>

    <span class="comment">#1) if letters &lt; 3 : return 1</span>
    <span class="keyword">if</span> <span style="color: #007020">len</span>(word) <span style="color: #333333">&lt;=</span> <span class="int">3</span> :
        syls <span style="color: #333333">=</span> <span class="int">1</span>
        <span class="keyword">return</span> syls

    <span class="comment">#2) if doesn&#39;t end with &quot;ted&quot; or &quot;tes&quot; or &quot;ses&quot; or &quot;ied&quot; or &quot;ies&quot;, discard &quot;es&quot; and &quot;ed&quot; at the end.</span>
    <span class="comment"># if it has only 1 vowel or 1 set of consecutive vowels, discard. (like &quot;speed&quot;, &quot;fled&quot; etc.)</span>

    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">2</span>:] <span style="color: #333333">==</span> <span class="string">&quot;es&quot;</span> <span style="color: #000000; font-weight: bold">or</span> word[<span style="color: #333333">-</span><span class="int">2</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ed&quot;</span> :
        doubleAndtripple_1 <span style="color: #333333">=</span> <span style="color: #007020">len</span>(re<span style="color: #333333">.</span>findall(<span class="string">r&#39;[eaoui][eaoui]&#39;</span>,word))
        <span class="keyword">if</span> doubleAndtripple_1 <span style="color: #333333">&gt;</span> <span class="int">1</span> <span style="color: #000000; font-weight: bold">or</span> <span style="color: #007020">len</span>(re<span style="color: #333333">.</span>findall(<span class="string">r&#39;[eaoui][^eaoui]&#39;</span>,word)) <span style="color: #333333">&gt;</span> <span class="int">1</span> :
            <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ted&quot;</span> <span style="color: #000000; font-weight: bold">or</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;tes&quot;</span> <span style="color: #000000; font-weight: bold">or</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ses&quot;</span> <span style="color: #000000; font-weight: bold">or</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ied&quot;</span> <span style="color: #000000; font-weight: bold">or</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ies&quot;</span> :
                <span class="keyword">pass</span>
            <span class="keyword">else</span> :
                disc<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#3) discard trailing &quot;e&quot;, except where ending is &quot;le&quot;  </span>

    le_except <span style="color: #333333">=</span> [<span class="string">&#39;whole&#39;</span>,<span class="string">&#39;mobile&#39;</span>,<span class="string">&#39;pole&#39;</span>,<span class="string">&#39;male&#39;</span>,<span class="string">&#39;female&#39;</span>,<span class="string">&#39;hale&#39;</span>,<span class="string">&#39;pale&#39;</span>,<span class="string">&#39;tale&#39;</span>,<span class="string">&#39;sale&#39;</span>,<span class="string">&#39;aisle&#39;</span>,<span class="string">&#39;whale&#39;</span>,<span class="string">&#39;while&#39;</span>]

    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">1</span>:] <span style="color: #333333">==</span> <span class="string">&quot;e&quot;</span> :
        <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">2</span>:] <span style="color: #333333">==</span> <span class="string">&quot;le&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> le_except :
            <span class="keyword">pass</span>

        <span class="keyword">else</span> :
            disc<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#4) check if consecutive vowels exists, triplets or pairs, count them as one.</span>

    doubleAndtripple <span style="color: #333333">=</span> <span style="color: #007020">len</span>(re<span style="color: #333333">.</span>findall(<span class="string">r&#39;[eaoui][eaoui]&#39;</span>,word))
    tripple <span style="color: #333333">=</span> <span style="color: #007020">len</span>(re<span style="color: #333333">.</span>findall(<span class="string">r&#39;[eaoui][eaoui][eaoui]&#39;</span>,word))
    disc<span style="color: #333333">+=</span>doubleAndtripple <span style="color: #333333">+</span> tripple

    <span class="comment">#5) count remaining vowels in word.</span>
    numVowels <span style="color: #333333">=</span> <span style="color: #007020">len</span>(re<span style="color: #333333">.</span>findall(<span class="string">r&#39;[eaoui]&#39;</span>,word))

    <span class="comment">#6) add one if starts with &quot;mc&quot;</span>
    <span class="keyword">if</span> word[:<span class="int">2</span>] <span style="color: #333333">==</span> <span class="string">&quot;mc&quot;</span> :
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#7) add one if ends with &quot;y&quot; but is not surrouned by vowel</span>
    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">1</span>:] <span style="color: #333333">==</span> <span class="string">&quot;y&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span style="color: #333333">-</span><span class="int">2</span>] <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
        syls <span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#8) add one if &quot;y&quot; is surrounded by non-vowels and is not in the last word.</span>

    <span class="keyword">for</span> i,j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">enumerate</span>(word) :
        <span class="keyword">if</span> j <span style="color: #333333">==</span> <span class="string">&quot;y&quot;</span> :
            <span class="keyword">if</span> (i <span style="color: #333333">!=</span> <span class="int">0</span>) <span style="color: #000000; font-weight: bold">and</span> (i <span style="color: #333333">!=</span> <span style="color: #007020">len</span>(word)<span style="color: #333333">-</span><span class="int">1</span>) :
                <span class="keyword">if</span> word[i<span style="color: #333333">-</span><span class="int">1</span>] <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[i<span style="color: #333333">+</span><span class="int">1</span>] <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
                    syls<span style="color: #333333">+=</span><span class="int">1</span>


    <span class="comment">#9) if starts with &quot;tri-&quot; or &quot;bi-&quot; and is followed by a vowel, add one.</span>

    <span class="keyword">if</span> word[:<span class="int">3</span>] <span style="color: #333333">==</span> <span class="string">&quot;tri&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">3</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="keyword">if</span> word[:<span class="int">2</span>] <span style="color: #333333">==</span> <span class="string">&quot;bi&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">2</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#10) if ends with &quot;-ian&quot;, should be counted as two syllables, except for &quot;-tian&quot; and &quot;-cian&quot;</span>

    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ian&quot;</span> :
    <span class="comment">#and (word[-4:] != &quot;cian&quot; or word[-4:] != &quot;tian&quot;) :</span>
        <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">4</span>:] <span style="color: #333333">==</span> <span class="string">&quot;cian&quot;</span> <span style="color: #000000; font-weight: bold">or</span> word[<span style="color: #333333">-</span><span class="int">4</span>:] <span style="color: #333333">==</span> <span class="string">&quot;tian&quot;</span> :
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#11) if starts with &quot;co-&quot; and is followed by a vowel, check if exists in the double syllable dictionary, if not, check if in single dictionary and act accordingly.</span>

    <span class="keyword">if</span> word[:<span class="int">2</span>] <span style="color: #333333">==</span> <span class="string">&quot;co&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">2</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&#39;eaoui&#39;</span> :

        <span class="keyword">if</span> word[:<span class="int">4</span>] <span style="color: #000000; font-weight: bold">in</span> co_two <span style="color: #000000; font-weight: bold">or</span> word[:<span class="int">5</span>] <span style="color: #000000; font-weight: bold">in</span> co_two <span style="color: #000000; font-weight: bold">or</span> word[:<span class="int">6</span>] <span style="color: #000000; font-weight: bold">in</span> co_two :
            syls<span style="color: #333333">+=</span><span class="int">1</span>
        <span class="keyword">elif</span> word[:<span class="int">4</span>] <span style="color: #000000; font-weight: bold">in</span> co_one <span style="color: #000000; font-weight: bold">or</span> word[:<span class="int">5</span>] <span style="color: #000000; font-weight: bold">in</span> co_one <span style="color: #000000; font-weight: bold">or</span> word[:<span class="int">6</span>] <span style="color: #000000; font-weight: bold">in</span> co_one :
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#12) if starts with &quot;pre-&quot; and is followed by a vowel, check if exists in the double syllable dictionary, if not, check if in single dictionary and act accordingly.</span>

    <span class="keyword">if</span> word[:<span class="int">3</span>] <span style="color: #333333">==</span> <span class="string">&quot;pre&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">3</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&#39;eaoui&#39;</span> :
        <span class="keyword">if</span> word[:<span class="int">6</span>] <span style="color: #000000; font-weight: bold">in</span> pre_one :
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#13) check for &quot;-n&#39;t&quot; and cross match with dictionary to add syllable.</span>

    negative <span style="color: #333333">=</span> [<span class="string">&quot;doesn&#39;t&quot;</span>, <span class="string">&quot;isn&#39;t&quot;</span>, <span class="string">&quot;shouldn&#39;t&quot;</span>, <span class="string">&quot;couldn&#39;t&quot;</span>,<span class="string">&quot;wouldn&#39;t&quot;</span>]

    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;n&#39;t&quot;</span> :
        <span class="keyword">if</span> word <span style="color: #000000; font-weight: bold">in</span> negative :
            syls<span style="color: #333333">+=</span><span class="int">1</span>
        <span class="keyword">else</span> :
            <span class="keyword">pass</span>

    <span class="comment">#14) Handling the exceptional words.</span>

    <span class="keyword">if</span> word <span style="color: #000000; font-weight: bold">in</span> exception_del :
        disc<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="keyword">if</span> word <span style="color: #000000; font-weight: bold">in</span> exception_add :
        syls<span style="color: #333333">+=</span><span class="int">1</span>


    <span class="comment"># calculate the output</span>
<span class="keyword">return</span> numVowels <span style="color: #333333">-</span> disc <span style="color: #333333">+</span> syls
</pre></td></tr></table></div>

<p>This seemed like a lot just to count a few syllables. It made poor use of memory, too, by doing things like allocating variables that it then used one time. "Python programmers shouldn't worry about things like efficiency and memory usage"--but I do. I knew I could do better, and so I did.</p>

<h3>The Refactored Syllable Counter</h3>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span class="comment"># Method: MySyllableCount</span>
<span class="comment"># Purpose: Accept a word and return the number of syllables. Modded for speed.</span>
<span class="comment"># Parameters: </span>
<span class="comment"># - word: Word to be parsed. (String)</span>
<span class="comment"># H/t: https://github.com/eaydin/sylco</span>
<span class="keyword">def</span> <span style="color: #0066BB; font-weight: bold">MySyllableCount</span>(word):
    word <span style="color: #333333">=</span> word<span style="color: #333333">.</span>lower()

    syls <span style="color: #333333">=</span> <span class="int">0</span> <span class="comment"># Number of added syllables</span>
    disc <span style="color: #333333">=</span> <span class="int">0</span> <span class="comment"># Number of discarded syllables</span>

    <span class="comment">#1) If three or less letters, one syllable</span>
    <span class="keyword">if</span> <span style="color: #007020">len</span>(word) <span style="color: #333333">&lt;=</span> <span class="int">3</span> :
        <span class="keyword">return</span> <span class="int">1</span>

    <span class="comment">#2) If doesn&#39;t end with &quot;ted&quot; or &quot;tes&quot; or &quot;ses&quot; or &quot;ied&quot; or &quot;ies&quot;, discard &quot;es&quot; and &quot;ed&quot; at the end.</span>
    <span class="comment"># if it has only 1 vowel or 1 set of consecutive vowels, discard. (like &quot;speed&quot;, &quot;fled&quot; etc.)</span>
    double_vowel <span style="color: #333333">=</span> <span style="color: #007020">len</span>(findall(<span class="string">r&#39;[eaoui][eaoui]&#39;</span>,word))

    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">2</span>:] <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&quot;es&quot;</span>, <span class="string">&quot;ed&quot;</span>]:
        <span class="keyword">if</span> double_vowel <span style="color: #333333">&gt;</span> <span class="int">1</span> <span style="color: #000000; font-weight: bold">or</span> <span style="color: #007020">len</span>(findall(<span class="string">r&#39;[eaoui][^eaoui]&#39;</span>,word)) <span style="color: #333333">&gt;</span> <span class="int">1</span> :
            <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&quot;ted&quot;</span>, <span class="string">&quot;tes&quot;</span>, <span class="string">&quot;ses&quot;</span>, <span class="string">&quot;ied&quot;</span>, <span class="string">&quot;ies&quot;</span>]:
                <span class="keyword">pass</span>
            <span class="keyword">else</span>:
                disc<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#3) discard trailing &quot;e&quot;, except where ending is &quot;le&quot;  </span>
    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">1</span>:] <span style="color: #333333">==</span> <span class="string">&quot;e&quot;</span> :
        <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">2</span>:] <span style="color: #333333">==</span> <span class="string">&quot;le&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&#39;whole&#39;</span>,<span class="string">&#39;mobile&#39;</span>,<span class="string">&#39;pole&#39;</span>,<span class="string">&#39;male&#39;</span>,<span class="string">&#39;female&#39;</span>,<span class="string">&#39;hale&#39;</span>,<span class="string">&#39;pale&#39;</span>,<span class="string">&#39;tale&#39;</span>,<span class="string">&#39;sale&#39;</span>,<span class="string">&#39;aisle&#39;</span>,<span class="string">&#39;whale&#39;</span>,<span class="string">&#39;while&#39;</span>]:
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            disc<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#4) check if consecutive vowels exists, triplets or pairs, count them as one.</span>
    disc <span style="color: #333333">+=</span> double_vowel <span style="color: #333333">+</span> <span style="color: #007020">len</span>(findall(<span class="string">r&#39;[eaoui][eaoui][eaoui]&#39;</span>,word))

    <span class="comment">#5) count remaining vowels in word.</span>
    numVowels <span style="color: #333333">=</span> <span style="color: #007020">len</span>(findall(<span class="string">r&#39;[eaoui]&#39;</span>,word))

    <span class="comment">#6) add one if starts with &quot;mc&quot;</span>
    <span class="keyword">if</span> word[:<span class="int">2</span>] <span style="color: #333333">==</span> <span class="string">&quot;mc&quot;</span> :
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#7) add one if ends with &quot;y&quot; but is not surrouned by vowel</span>
    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">1</span>:] <span style="color: #333333">==</span> <span class="string">&quot;y&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span style="color: #333333">-</span><span class="int">2</span>] <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
        syls <span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#8) add one if &quot;y&quot; is surrounded by non-vowels and is not in the last word.</span>
    <span class="keyword">for</span> i,j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">enumerate</span>(word) :
        <span class="keyword">if</span> j <span style="color: #333333">==</span> <span class="string">&quot;y&quot;</span> :
            <span class="keyword">if</span> (i <span style="color: #333333">!=</span> <span class="int">0</span>) <span style="color: #000000; font-weight: bold">and</span> (i <span style="color: #333333">!=</span> <span style="color: #007020">len</span>(word)<span style="color: #333333">-</span><span class="int">1</span>) :
                <span class="keyword">if</span> word[i<span style="color: #333333">-</span><span class="int">1</span>] <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[i<span style="color: #333333">+</span><span class="int">1</span>] <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
                    syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#9) if starts with &quot;tri-&quot; or &quot;bi-&quot; and is followed by a vowel, add one.</span>
    <span class="keyword">if</span> word[:<span class="int">3</span>] <span style="color: #333333">==</span> <span class="string">&quot;tri&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">3</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="keyword">if</span> word[:<span class="int">2</span>] <span style="color: #333333">==</span> <span class="string">&quot;bi&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">2</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&quot;aeoui&quot;</span> :
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#10) if ends with &quot;-ian&quot;, should be counted as two syllables, except for &quot;-tian&quot; and &quot;-cian&quot;</span>
    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;ian&quot;</span> :
        <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">4</span>:] <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&quot;cian&quot;</span>, <span class="string">&quot;tian&quot;</span>]:
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#11) if starts with &quot;co-&quot; and is followed by a vowel, check if exists in the double syllable dictionary, if not, check if in single dictionary and act accordingly.</span>
    <span class="keyword">if</span> word[:<span class="int">2</span>] <span style="color: #333333">==</span> <span class="string">&quot;co&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">2</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&#39;eaoui&#39;</span> :
        <span class="keyword">if</span> (<span style="color: #007020">set</span>([<span class="string">&#39;coapt&#39;</span>,<span class="string">&#39;coed&#39;</span>,<span class="string">&#39;coinci&#39;</span>])<span style="color: #333333">.</span>intersection([word[:<span class="int">4</span>], word[:<span class="int">5</span>], word[:<span class="int">6</span>]])):
            syls<span style="color: #333333">+=</span><span class="int">1</span>
        <span class="keyword">elif</span> (<span style="color: #007020">set</span>([<span class="string">&#39;cool&#39;</span>,<span class="string">&#39;coach&#39;</span>,<span class="string">&#39;coat&#39;</span>,<span class="string">&#39;coal&#39;</span>,<span class="string">&#39;count&#39;</span>,<span class="string">&#39;coin&#39;</span>,<span class="string">&#39;coarse&#39;</span>,<span class="string">&#39;coup&#39;</span>,<span class="string">&#39;coif&#39;</span>,<span class="string">&#39;cook&#39;</span>,<span class="string">&#39;coign&#39;</span>,<span class="string">&#39;coiffe&#39;</span>,<span class="string">&#39;coof&#39;</span>,<span class="string">&#39;court&#39;</span>])<span style="color: #333333">.</span>intersection([word[:<span class="int">4</span>], word[:<span class="int">5</span>], word[:<span class="int">6</span>]])):
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#12) if starts with &quot;pre-&quot; and is followed by a vowel, check if exists in the double syllable dictionary, if not, check if in single dictionary and act accordingly.</span>
    <span class="keyword">if</span> word[:<span class="int">3</span>] <span style="color: #333333">==</span> <span class="string">&quot;pre&quot;</span> <span style="color: #000000; font-weight: bold">and</span> word[<span class="int">3</span>] <span style="color: #000000; font-weight: bold">in</span> <span class="string">&#39;eaoui&#39;</span> :
        <span class="keyword">if</span> word[:<span class="int">6</span>] <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&#39;preach&#39;</span>]:
            <span class="keyword">pass</span>
        <span class="keyword">else</span> :
            syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment">#13) check for &quot;-n&#39;t&quot; and cross match with dictionary to add syllable.</span>
    <span class="keyword">if</span> word[<span style="color: #333333">-</span><span class="int">3</span>:] <span style="color: #333333">==</span> <span class="string">&quot;n&#39;t&quot;</span> :
        <span class="keyword">if</span> word <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&quot;doesn&#39;t&quot;</span>, <span class="string">&quot;isn&#39;t&quot;</span>, <span class="string">&quot;shouldn&#39;t&quot;</span>, <span class="string">&quot;couldn&#39;t&quot;</span>,<span class="string">&quot;wouldn&#39;t&quot;</span>]:
            syls<span style="color: #333333">+=</span><span class="int">1</span>
        <span class="keyword">else</span>:
            <span class="keyword">pass</span>

    <span class="comment">#14) Handling the exceptional words.</span>
    <span class="comment"># exception_del are words that need less syllables</span>
    <span class="keyword">if</span> word <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&#39;fortunately&#39;</span>,<span class="string">&#39;unfortunately&#39;</span>]:
        disc<span style="color: #333333">+=</span><span class="int">1</span>
    <span class="comment"># exception_add are words that need extra syllables</span>
    <span class="keyword">if</span> word <span style="color: #000000; font-weight: bold">in</span> [<span class="string">&#39;serious&#39;</span>,<span class="string">&#39;crucial&#39;</span>]:
        syls<span style="color: #333333">+=</span><span class="int">1</span>

    <span class="comment"># calculate the output</span>
<span class="keyword">return</span> numVowels <span style="color: #333333">-</span> disc <span style="color: #333333">+</span> syls
</pre></td></tr></table></div>

<p>Take comments and whitespace out, and Emre's counter comes in at 70 lines long. My version sits at 66 lines but cuts runtime by 9%. It pays to worry about things like efficiency and memory usage after all. As I marveled at my own brilliance, though, I realized that this might not matter. Emre gave this a shot back in 2016 with no guarantee of its accuracy. Cutting runtime by any number meant nothing if the algorithm did not work. Before I spent any more time trimming an unproven script, I needed to test it against a known good source; I needed to test it against a dictionary.</p>

<p>This seemed like an easy task:</p>

<ol>
    <li>Read a word from the dictionary</li>
    <li>Use the algorithm to count its syllables</li>
    <li>Compare the algorithm's count to the dictionary's</li>
</ol>

<p>As long as the algorithm gave me the right syllable count most of the time, I could speed it up, make it more accurate, and then repeat that process as many times as I wanted. I ran into problems starting with step one, though: UNIX has no native dictionary. It does have a wordlist, with over 200,000 words, but I needed a dictionary to give me valid words *and* the number of syllables they contained. Without that number, from an authoritative source, I had nothing to test the algorithm's accuracy.</p>

<p>Because I needed my script to pull words and syllable counts from the dictionary, I needed something with a command line interface. The built-in dictionary app on my Mac, <code>dictionary.app</code>, seemed like an easy answer, but supports only [basic programatic access](https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/DictionaryServicesProgGuide/access/access.html). <code>dictd</code> looked like it fit the bill, but I had trouble getting it to install. It "succeeded", but never ran. A third-party dictionary violated my self-reliance principle anyway, so I cleared all the install files and went back to my old standby: web scraping.</p>

<p>My script started out simple. Read words from the UNIX wordlist at <code>/usr/share/dict/words</code>, get a syllable breakdown from Google or <a href="https://howmanysyllables.com">HowManySyllables.com</a>, and record the result in a new wordlist. Check out my first try below.</p>

<h3>Syllable Dictionary Builder, version 1</h3>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: BuildSyllableDictionary</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Enrich wordlist with true syllables from a dictionary</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">BuildSyllableDictionary</span>():
    <span style="color: #aaaaaa; font-style: italic"># Create a new instance of the web scraper</span>
    s = Scraper()

    <span style="color: #aaaaaa; font-style: italic"># Open the wordlist</span>
    s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;/usr/share/dict/words&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Create the syllable dictionary file if it does not exist.</span>
    <span style="color: #0000aa">if</span> (<span style="color: #0000aa">not</span> exists(<span style="color: #aa5500">&quot;./syllable_dictionary.txt&quot;</span>)):
        <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_dictionary.txt&quot;</span>, <span style="color: #aa5500">&quot;w&quot;</span>).close()

    <span style="color: #aaaaaa; font-style: italic"># Open the syllable dictionary</span>
    c_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_dictionary.txt&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Clear and open a temporary output syllable dictionary, to write to.</span>
    <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_dictionary.txt.bak&quot;</span>, <span style="color: #aa5500">&quot;w&quot;</span>).close()
    d_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_dictionary.txt.bak&quot;</span>, <span style="color: #aa5500">&quot;a&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Enumerate the wordlist</span>
    <span style="color: #0000aa">for</span> i, word <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
        <span style="color: #aaaaaa; font-style: italic"># Convert wordlist word to lowercase and strip newline</span>
        word = word.lower().strip()

        <span style="color: #aaaaaa; font-style: italic"># Read a line from the syllable dictionary</span>
        comp = c_fd.readline().split(<span style="color: #aa5500">&quot;,&quot;</span>)[<span style="color: #009999">0</span>].strip()

        <span style="color: #aaaaaa; font-style: italic"># If the word in the wordlist has already been added to the syllable</span>
        <span style="color: #aaaaaa; font-style: italic"># dictionary, skip it.</span>
        <span style="color: #0000aa">if</span> (word == comp):
            <span style="color: #0000aa">continue</span>

        <span style="color: #aaaaaa; font-style: italic"># Query Google for the definition of the wordlist&#39;s word. Depending on</span>
        <span style="color: #aaaaaa; font-style: italic"># the user agent string, the number of syllables may be in a span or</span>
        <span style="color: #aaaaaa; font-style: italic"># div. If neither element is in the response, try another source.</span>
        resp = s.scrape(<span style="color: #aa5500">&quot;https://google.com/search?q=define%20&quot;</span>+word)
        <span style="color: #0000aa">if</span> (<span style="color: #aa5500">&#39;&lt;span data-dobid=&quot;hdw&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp):
            resp = resp.split(<span style="color: #aa5500">&#39;&lt;span data-dobid=&quot;hdw&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&quot;&lt;/span&gt;&quot;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">0</span>]
            <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>)
            d_fd.write(word+<span style="color: #aa5500">&quot;,&quot;</span>+<span style="color: #00aaaa">str</span>(resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>)+<span style="color: #aa5500">&#39;\n&#39;</span>)
            <span style="color: #0000aa">continue</span>
        <span style="color: #0000aa">elif</span> (<span style="color: #aa5500">&#39;&lt;div data-hveid=&quot;20&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp):
            resp = resp.split(<span style="color: #aa5500">&#39;&lt;div data-hveid=&quot;20&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&quot;&gt;&quot;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&quot;&lt;&quot;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">0</span>]
            <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>)
            d_fd.write(word+<span style="color: #aa5500">&quot;,&quot;</span>+<span style="color: #00aaaa">str</span>(resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>)+<span style="color: #aa5500">&#39;\n&#39;</span>)
            <span style="color: #0000aa">continue</span>
        <span style="color: #0000aa">else</span>:
            resp = <span style="color: #aa5500">&quot;&quot;</span>

        <span style="color: #aaaaaa; font-style: italic"># If Google does not have a syllable breakdown for the target word,</span>
        <span style="color: #aaaaaa; font-style: italic"># try HowManySyllables.com.</span>
        <span style="color: #0000aa">if</span> (resp == <span style="color: #aa5500">&quot;&quot;</span>):
            resp = s.scrape(<span style="color: #aa5500">&quot;https://www.howmanysyllables.com/words/&quot;</span>+word)

        <span style="color: #aaaaaa; font-style: italic"># If the response contains a certain paragraph, parse the number of</span>
        <span style="color: #aaaaaa; font-style: italic"># syllables. If not all has failed, so return -1 for the syllable count</span>
        <span style="color: #0000aa">if</span> (<span style="color: #aa5500">&#39;&lt;p id=&quot;SyllableContentContainer&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp <span style="color: #0000aa">and</span> <span style="color: #aa5500">&#39;&lt;span class=&quot;Answer_Red&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp.split(<span style="color: #aa5500">&#39;&lt;p id=&quot;SyllableContentContainer&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>]):
            resp = resp.split(<span style="color: #aa5500">&#39;&lt;p id=&quot;SyllableContentContainer&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&#39;&lt;span class=&quot;Answer_Red&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&#39;&lt;/span&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">0</span>]
            <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,resp.count(<span style="color: #aa5500">&quot;-&quot;</span>)+<span style="color: #009999">1</span>)
            d_fd.write(word+<span style="color: #aa5500">&quot;,&quot;</span>+<span style="color: #00aaaa">str</span>(resp.count(<span style="color: #aa5500">&quot;-&quot;</span>)+<span style="color: #009999">1</span>)+<span style="color: #aa5500">&#39;\n&#39;</span>)
        <span style="color: #0000aa">else</span>:
            <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,-<span style="color: #009999">1</span>)
            d_fd.write(word+<span style="color: #aa5500">&quot;,&quot;</span>+<span style="color: #00aaaa">str</span>(-<span style="color: #009999">1</span>)+<span style="color: #aa5500">&#39;\n&#39;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Close all files</span>
    s_fd.close()
    d_fd.close()
    c_fd.close()

    <span style="color: #aaaaaa; font-style: italic"># Append the temporary syllable dictionary to the actual</span>
    <span style="color: #aaaaaa; font-style: italic"># syllable dictionary, then remove the temp file.</span>
    s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_dictionary.txt.bak&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)
    d_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_dictionary.txt&quot;</span>, <span style="color: #aa5500">&quot;a&quot;</span>)
    <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
        d_fd.write(line)

    <span style="color: #aaaaaa; font-style: italic"># Close files</span>
    s_fd.close()
    d_fd.close()

    <span style="color: #aaaaaa; font-style: italic"># Cleanup</span>
    remove(<span style="color: #aa5500">&quot;./syllable_dictionary.txt.bak&quot;</span>)
    <span style="color: #0000aa">del</span> s
</pre></td></tr></table></div>

<p>It took almost two days to get through A and B, at just over 25,000 words. I did not have the patience to spend a month working through the other 90% of the dataset, so I made some changes for B to Z.</p>

<p>First, I split up the 235,886 line wordlist by letter. This gave me twenty-six sub-wordlists: <code>a.txt</code>, <code>b.txt</code>, and so on.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: SplitUpWordlist</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Break wordlist into sub-wordlists by letter of alphabet</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">SplitUpWordlist</span>():
    <span style="color: #aaaaaa; font-style: italic"># Open the wordlist</span>
    wordlist_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;/usr/share/dict/words&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Keep track of which letters have their own output file</span>
    alphabet = []

    <span style="color: #aaaaaa; font-style: italic"># Enumerate the wordlist. For each letter, create a new wordlist file in</span>
    <span style="color: #aaaaaa; font-style: italic"># the form {letter}.txt, that contains all letters starting with {letter}.</span>
    <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(wordlist_fd):
        <span style="color: #aaaaaa; font-style: italic"># Transform the wordlist&#39;s word</span>
        line = line.strip().lower()

        <span style="color: #aaaaaa; font-style: italic"># If the script has not processed {letter} yet, create {letter}.txt</span>
        <span style="color: #aaaaaa; font-style: italic"># and write all words starting with {letter} to it.</span>
        <span style="color: #0000aa">if</span> (line[<span style="color: #009999">0</span>] <span style="color: #0000aa">not</span> <span style="color: #0000aa">in</span> alphabet):
            <span style="color: #0000aa">try</span>:
                d_fd.close()
            <span style="color: #0000aa">except</span>:
                <span style="color: #0000aa">pass</span>
            <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+line[<span style="color: #009999">0</span>]+<span style="color: #aa5500">&quot;.txt&quot;</span>, <span style="color: #aa5500">&quot;w&quot;</span>).close()
            d_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+line[<span style="color: #009999">0</span>]+<span style="color: #aa5500">&quot;.txt&quot;</span>, <span style="color: #aa5500">&quot;a&quot;</span>)
            d_fd.write(line+<span style="color: #aa5500">&#39;\n&#39;</span>)
        <span style="color: #0000aa">else</span>:
            d_fd.write(line+<span style="color: #aa5500">&#39;\n&#39;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Close the file</span>
    wordlist_fd.close()
</pre></td></tr></table></div>

<p>It would have taken me another twenty-six days to work through those twenty-six wordlists, so I decided to put my quad core processor to work by enabling multiprocessing. Python's handy <code>multiprocessing</code> module would farm out each dictionary lookup to its own core, which would allow me to use all eight of my logical processors to make quick work of this task. <code>BuildSyllableDictionaryWithMultiprocessing</code> farmed a sub-wordlist out to each processor. <code>BuildDictionary</code> enumerated the sub-wordlist to build the syllable dictionary. <code>DownloadSyllable</code> did the web scraping to capture the syllable count.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: BuildSyllableDictionaryWithMultiprocessing</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Enrich wordlist with syllables from dictionary, with multiprocessing</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">BuildSyllableDictionaryWithMultiprocessing</span>():
    <span style="color: #aaaaaa; font-style: italic"># Find all source files of the form {letter}.txt</span>
    files = [x <span style="color: #0000aa">for</span> x <span style="color: #0000aa">in</span> listdir(<span style="color: #aa5500">&quot;./&quot;</span>) <span style="color: #0000aa">if</span> <span style="color: #00aaaa">len</span>(x) == <span style="color: #009999">5</span>]

    <span style="color: #aaaaaa; font-style: italic"># Use multithreading to speed up capturing syllables for entire dictionary</span>
    <span style="color: #0000aa">with</span> Pool() <span style="color: #0000aa">as</span> pool:
        pool.map(BuildDictionary, files)

<span style="color: #aaaaaa; font-style: italic"># Method: BuildDictionary</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Capture syllables for all words in a wordlist</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters:</span>
<span style="color: #aaaaaa; font-style: italic"># - tgt: Source wordlist (String)</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">BuildDictionary</span>(tgt):
    <span style="color: #aaaaaa; font-style: italic"># Clear an interim output file, then open for appending</span>
    <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./interim_&quot;</span> + tgt, <span style="color: #aa5500">&quot;w&quot;</span>).close()
    d_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./interim_&quot;</span> + tgt, <span style="color: #aa5500">&quot;a&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Open the source wordlist</span>
    s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span> + tgt, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Open the existing syllable dictionary</span>
    c_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_&quot;</span> + tgt, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Enumerate the wordlist. </span>
    <span style="color: #0000aa">for</span> i,word <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
        <span style="color: #aaaaaa; font-style: italic"># Convert wordlist word to lowercase and strip newline</span>
        word = word.lower().strip()

        <span style="color: #aaaaaa; font-style: italic"># Read a line from the syllable dictionary</span>
        comp = c_fd.readline().split(<span style="color: #aa5500">&quot;,&quot;</span>)[<span style="color: #009999">0</span>].lower().strip()

        <span style="color: #aaaaaa; font-style: italic"># If the word in the wordlist has already been added to the syllable</span>
        <span style="color: #aaaaaa; font-style: italic"># dictionary, skip it.</span>
        <span style="color: #0000aa">if</span> (comp == word):
            <span style="color: #0000aa">continue</span>

        <span style="color: #aaaaaa; font-style: italic"># If the word has not been added to the syllable dictionary, capture</span>
        <span style="color: #aaaaaa; font-style: italic"># the syllable count and append the word and that number to the dict.</span>
        d_fd.write(line + <span style="color: #aa5500">&quot;,&quot;</span> + <span style="color: #00aaaa">str</span>(DownloadSyllable(line)) + <span style="color: #aa5500">&#39;\n&#39;</span>)


    <span style="color: #aaaaaa; font-style: italic"># Close all files</span>
    d_fd.close()
    s_fd.close()
    c_fd.close()

    <span style="color: #aaaaaa; font-style: italic"># Append the temporary syllable dictionary to the actual</span>
    <span style="color: #aaaaaa; font-style: italic"># syllable dictionary, then remove the temp file.</span>
    s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./interim_&quot;</span> + tgt, <span style="color: #aa5500">&quot;r&quot;</span>)
    d_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span> + tgt, <span style="color: #aa5500">&quot;a&quot;</span>)
    <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
        d_fd.write(line)

    <span style="color: #aaaaaa; font-style: italic"># Close files</span>
    d_fd.close()
    s_fd.close()

    <span style="color: #aaaaaa; font-style: italic"># Delete temp file</span>
    remove(<span style="color: #aa5500">&quot;./interim_&quot;</span>+tgt)

<span style="color: #aaaaaa; font-style: italic"># Method: DownloadSyllable</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Capture syllables for single word</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters:</span>
<span style="color: #aaaaaa; font-style: italic"># - word: Target word (String)</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">DownloadSyllable</span>(word):
    <span style="color: #aaaaaa; font-style: italic"># Create a new instance of the Scraper class. This is necessary since these</span>
    <span style="color: #aaaaaa; font-style: italic"># queries will be split up among multiple processors with dissimilar memory</span>
    s = Scraper()

    <span style="color: #aaaaaa; font-style: italic"># Query Google for the definition of the wordlist&#39;s word. Depending on</span>
    <span style="color: #aaaaaa; font-style: italic"># the user agent string, the number of syllables may be in a span or</span>
    <span style="color: #aaaaaa; font-style: italic"># div. If neither element is in the response, try another source.</span>
    resp = scrape(<span style="color: #aa5500">&quot;https://google.com/search?q=define%20&quot;</span>+word)
    <span style="color: #0000aa">if</span> (<span style="color: #aa5500">&#39;&lt;span data-dobid=&quot;hdw&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp):
        resp = resp.split(<span style="color: #aa5500">&#39;&lt;span data-dobid=&quot;hdw&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&quot;&lt;/span&gt;&quot;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">0</span>]
        <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>)
        <span style="color: #0000aa">return</span> resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>
    <span style="color: #0000aa">elif</span> (<span style="color: #aa5500">&#39;&lt;div data-hveid=&quot;20&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp):
        resp = resp.split(<span style="color: #aa5500">&#39;&lt;div data-hveid=&quot;20&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&quot;&gt;&quot;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&quot;&lt;&quot;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">0</span>]
        <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>)
        <span style="color: #0000aa">return</span> resp.count(<span style="color: #aa5500">&quot;路&quot;</span>)+<span style="color: #009999">1</span>
    <span style="color: #0000aa">else</span>:
        resp = <span style="color: #aa5500">&quot;&quot;</span>

    <span style="color: #aaaaaa; font-style: italic"># If Google does not have a syllable breakdown for the target word,</span>
    <span style="color: #aaaaaa; font-style: italic"># try HowManySyllables.com.</span>
    <span style="color: #0000aa">if</span> (resp == <span style="color: #aa5500">&quot;&quot;</span>):
        resp = scrape(<span style="color: #aa5500">&quot;https://www.howmanysyllables.com/words/&quot;</span>+word)

    <span style="color: #aaaaaa; font-style: italic"># If the response contains a certain paragraph, parse the number of</span>
    <span style="color: #aaaaaa; font-style: italic"># syllables. If not all has failed, so return -1 for the syllable count</span>
    <span style="color: #0000aa">if</span> (<span style="color: #aa5500">&#39;&lt;p id=&quot;SyllableContentContainer&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp <span style="color: #0000aa">and</span> <span style="color: #aa5500">&#39;&lt;span class=&quot;Answer_Red&quot;&gt;&#39;</span> <span style="color: #0000aa">in</span> resp.split(<span style="color: #aa5500">&#39;&lt;p id=&quot;SyllableContentContainer&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>]):
        resp = resp.split(<span style="color: #aa5500">&#39;&lt;p id=&quot;SyllableContentContainer&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&#39;&lt;span class=&quot;Answer_Red&quot;&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">1</span>].split(<span style="color: #aa5500">&#39;&lt;/span&gt;&#39;</span>,<span style="color: #009999">1</span>)[<span style="color: #009999">0</span>]
        <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,resp.count(<span style="color: #aa5500">&quot;-&quot;</span>)+<span style="color: #009999">1</span>)
        <span style="color: #0000aa">return</span> resp.count(<span style="color: #aa5500">&quot;-&quot;</span>)+<span style="color: #009999">1</span>
    <span style="color: #0000aa">else</span>:
        <span style="color: #00aaaa">print</span>(word,<span style="color: #aa5500">&quot;,&quot;</span>,-<span style="color: #009999">1</span>)
        <span style="color: #0000aa">return</span> -<span style="color: #009999">1</span>

    <span style="color: #aaaaaa; font-style: italic"># Cleanup</span>
    <span style="color: #0000aa">del</span> s
</pre></td></tr></table></div>

<p>Within a few minutes, Google blocked me. I gave cloud infrastructure a try, but Google just kept blocking my <strike>DoS</strike> scraper after about 300 connections. I had to write a new method to recover from these failures.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: RecoverFromError</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Append contents of partial temp files to syllable dictionaries.</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">RecoverFromError</span>():
    <span style="color: #aaaaaa; font-style: italic"># Find all temp source files</span>
    files = [x <span style="color: #0000aa">for</span> x <span style="color: #0000aa">in</span> listdir(<span style="color: #aa5500">&quot;./&quot;</span>) <span style="color: #0000aa">if</span> <span style="color: #aa5500">&quot;.txt&quot;</span> <span style="color: #0000aa">in</span> x <span style="color: #0000aa">and</span> <span style="color: #aa5500">&quot;interim&quot;</span> <span style="color: #0000aa">in</span> x]

    <span style="color: #aaaaaa; font-style: italic"># Append cotnents of partial temp files to syllable dictionary</span>
    <span style="color: #0000aa">for</span> tgt <span style="color: #0000aa">in</span> files:
        <span style="color: #aaaaaa; font-style: italic"># Open the files</span>
        s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+tgt, <span style="color: #aa5500">&quot;r&quot;</span>)
        d_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+tgt.replace(<span style="color: #aa5500">&quot;interim&quot;</span>, <span style="color: #aa5500">&quot;syllable&quot;</span>), <span style="color: #aa5500">&quot;a+&quot;</span>)

        <span style="color: #aaaaaa; font-style: italic"># Do the copying</span>
        <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
            d_fd.write(line)

        <span style="color: #aaaaaa; font-style: italic"># Close the files</span>
        d_fd.close()
        s_fd.close()
</pre></td></tr></table></div>

<p>How Many Syllables never did block me, so I just commented out the part that checked Google first and drove on. Within a day, I had syllable count for all twenty-six sub-wordlists. <code>FinalCheck</code> made sure each sub-wordlist was not missing any words, <code>CombineWordlists</code> produced a master syllable dictionary I named <code>webS</code>, and <code>CompareWordlists</code> made sure the syllable dictionary had all the words from the original wordlist.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: FinalCheck</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Compare wordlists to syllable dictionaries</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">FinalCheck</span>():
    <span style="color: #aaaaaa; font-style: italic"># Find all source wordlists of the form {letter}.txt</span>
    files = <span style="color: #00aaaa">sorted</span>([x <span style="color: #0000aa">for</span> x <span style="color: #0000aa">in</span> listdir(<span style="color: #aa5500">&quot;./&quot;</span>) <span style="color: #0000aa">if</span> <span style="color: #aa5500">&quot;.txt&quot;</span> <span style="color: #0000aa">in</span> x <span style="color: #0000aa">and</span> <span style="color: #00aaaa">len</span>(x) == <span style="color: #009999">5</span>])

    <span style="color: #aaaaaa; font-style: italic"># Compare each wordlist to its syllable dictionary, to make sure syllable</span>
    <span style="color: #aaaaaa; font-style: italic"># dictionary has all words from the source wordlist.</span>
    <span style="color: #0000aa">for</span> tgt <span style="color: #0000aa">in</span> files:
        <span style="color: #aaaaaa; font-style: italic"># Open the source wordlist and attempt to open syllable dictionary.</span>
        <span style="color: #aaaaaa; font-style: italic"># If the dictionary does not yet exist, notify the user.</span>
        source_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+tgt, <span style="color: #aa5500">&quot;r&quot;</span>)
        <span style="color: #0000aa">if</span> (<span style="color: #0000aa">not</span> exists(<span style="color: #aa5500">&quot;./syllable_&quot;</span>+tgt)):
            <span style="color: #00aaaa">print</span>(<span style="color: #aa5500">&quot;File &#39;%s&#39; does not exist.&quot;</span> % (<span style="color: #aa5500">&quot;./syllable_&quot;</span>+tgt))
            <span style="color: #0000aa">continue</span>

        <span style="color: #aaaaaa; font-style: italic"># Open the syllable dictionary</span>
        sylls_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./syllable_&quot;</span>+tgt, <span style="color: #aa5500">&quot;r&quot;</span>)

        <span style="color: #aaaaaa; font-style: italic"># Instantiate boolean to track similarity</span>
        notTheSame = <span style="color: #0000aa">False</span>

        <span style="color: #aaaaaa; font-style: italic"># Enumerate the wordlist.</span>
        <span style="color: #0000aa">for</span> i,source_line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(source_fd):
            <span style="color: #aaaaaa; font-style: italic"># Read a line from the source wordlist and the syllable dictionary</span>
            source_line = source_line.strip().lower()
            sylls_line = sylls_fd.readline().split(<span style="color: #aa5500">&quot;,&quot;</span>)[<span style="color: #009999">0</span>].strip().lower()

            <span style="color: #aaaaaa; font-style: italic"># If the lines do not match, notify the user and set the boolean.</span>
            <span style="color: #0000aa">if</span> (source_line != sylls_line):
                <span style="color: #00aaaa">print</span>(<span style="color: #aa5500">&quot;Source line %d, &#39;%s&#39;, and syllable dictionary line, &#39;%s&#39;, do not match.&quot;</span> % (i, source_line, sylls_line))
                notTheSame = <span style="color: #0000aa">True</span>

        <span style="color: #aaaaaa; font-style: italic"># Close all files</span>
        source_fd.close()
        sylls_fd.close()

        <span style="color: #aaaaaa; font-style: italic"># Tell the user whether the syllable dictionary has all the words from</span>
        <span style="color: #aaaaaa; font-style: italic"># the wordlist or if they diverge.</span>
        <span style="color: #0000aa">if</span> (notTheSame):
            <span style="color: #00aaaa">print</span>(tgt,<span style="color: #aa5500">&quot;and&quot;</span>,<span style="color: #aa5500">&quot;./syllable_&quot;</span>+tgt+<span style="color: #aa5500">&quot; are not the same.&quot;</span>)
        <span style="color: #0000aa">else</span>:
            <span style="color: #00aaaa">print</span>(tgt,<span style="color: #aa5500">&quot;and&quot;</span>,<span style="color: #aa5500">&quot;./syllable_&quot;</span>+tgt+<span style="color: #aa5500">&quot; ARE the same.&quot;</span>)

<span style="color: #aaaaaa; font-style: italic"># Method: CombineWordlists</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Combine disparate sub-wordlists into a single wordlist.</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters:</span>
<span style="color: #aaaaaa; font-style: italic"># - name: Filename for the monolithic wordlist (String)</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">CombineWordlists</span>(name):
    <span style="color: #aaaaaa; font-style: italic"># Find all sub-wordlists like syllable_{letter}.txt. Sort alphabetically.</span>
    files = <span style="color: #00aaaa">sorted</span>([x <span style="color: #0000aa">for</span> x <span style="color: #0000aa">in</span> listdir(<span style="color: #aa5500">&quot;./&quot;</span>) <span style="color: #0000aa">if</span> <span style="color: #aa5500">&quot;syllable_&quot;</span> <span style="color: #0000aa">in</span> x <span style="color: #0000aa">and</span> <span style="color: #aa5500">&quot;.txt&quot;</span> <span style="color: #0000aa">in</span> x])

    <span style="color: #aaaaaa; font-style: italic"># Clear the master wordlist, then open for appending sub-wordlists</span>
    <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+name, <span style="color: #aa5500">&quot;w&quot;</span>).close()
    master_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+name, <span style="color: #aa5500">&quot;a&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Open each wordlist and write its contents to the master wordlist.</span>
    <span style="color: #0000aa">for</span> sub_wordlist <span style="color: #0000aa">in</span> files:
        sub_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./&quot;</span>+sub_wordlist, <span style="color: #aa5500">&quot;r&quot;</span>)
        <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(sub_fd):
            master_fd.write(line)
        <span style="color: #aaaaaa; font-style: italic"># Close file</span>
        sub_fd.close()
    <span style="color: #aaaaaa; font-style: italic"># Close file</span>
    master_fd.close()

<span style="color: #aaaaaa; font-style: italic"># Method: CompareWordlists</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Compare master wordlist with syllable dictionary.</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters:</span>
<span style="color: #aaaaaa; font-style: italic"># - master: File path for the master wordlist (String)</span>
<span style="color: #aaaaaa; font-style: italic"># - syl: File path for the syllable dictionary (String)</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">CompareWordlists</span>(master, syl):
    <span style="color: #aaaaaa; font-style: italic"># Open the wordlists</span>
    master_fd = <span style="color: #00aaaa">open</span>(master, <span style="color: #aa5500">&quot;r&quot;</span>)
    syl_fd = <span style="color: #00aaaa">open</span>(syl, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Enumerate the master wordlist</span>
    <span style="color: #0000aa">for</span> i,master_line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(master_fd):
        <span style="color: #aaaaaa; font-style: italic"># Read a line from the syllable dictionary</span>
        syl_line = syl_fd.readline()

        <span style="color: #aaaaaa; font-style: italic"># Transform the lines for comparison</span>
        master_line = master_line.lower().strip()
        syl_line = syl_line.split(<span style="color: #aa5500">&quot;,&quot;</span>)[<span style="color: #009999">0</span>].strip()

        <span style="color: #aaaaaa; font-style: italic"># Compare the two lines</span>
        <span style="color: #0000aa">if</span> (master_line != syl_line):
            <span style="color: #aaaaaa; font-style: italic"># Print the line number and the different words</span>
            <span style="color: #00aaaa">print</span>(<span style="color: #aa5500">&quot;Line %d: master &#39;%s&#39; vs syllable dictionary &#39;%s&#39;&quot;</span> % (i, master_line, syl_line))
            <span style="color: #aaaaaa; font-style: italic"># Exit so we can fix this line, then re-run</span>
            <span style="color: #0000aa">break</span>

    <span style="color: #aaaaaa; font-style: italic"># Close files</span>
    master_fd.close()
    syl_fd.close()
</pre></td></tr></table></div>

<p>So how did my web scraper do? <code>FindNoSyllables</code>--below--told me that out of 235,886 words in the wordlist, the scraper could not find syllables for 102,461. Not great.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: FindNoSyllables</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Find the words for which the dictionary does not count syllables</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">FindNoSyllables</span>():
    <span style="color: #aaaaaa; font-style: italic"># Open the syllable wordlist</span>
    s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./webS&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Keep track of the number of words without syllable counts</span>
    count = <span style="color: #009999">0</span>

    <span style="color: #aaaaaa; font-style: italic"># Enumerate the wordlist.</span>
    <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
        <span style="color: #aaaaaa; font-style: italic"># Get the word and it&#39;s syllable count</span>
        line = line.split(<span style="color: #aa5500">&quot;,&quot;</span>)
        word = line[<span style="color: #009999">0</span>].strip()
        sylls = <span style="color: #00aaaa">int</span>(line[<span style="color: #009999">1</span>])

        <span style="color: #aaaaaa; font-style: italic"># If the word has no syllable count, notify user and update total</span>
        <span style="color: #0000aa">if</span> (sylls == -<span style="color: #009999">1</span>):
            <span style="color: #00aaaa">print</span>(word)
            count += <span style="color: #009999">1</span>

    <span style="color: #aaaaaa; font-style: italic"># Close file</span>
    s_fd.close()

    <span style="color: #aaaaaa; font-style: italic"># Print count for user</span>
    <span style="color: #00aaaa">print</span>(count,<span style="color: #aa5500">&quot;records found.&quot;</span>)
</pre></td></tr></table></div>

<p>A cursory look through that list, though, revealed that many appeared to be proper nouns. I checked with a new method, creatively named <code>FindNoSyllablesAndNotProperNouns</code>.</p>

<!-- HTML generated using hilite.me --><div style="overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></td><td><pre style="background-color: transparent; padding: 0; margin: 0; line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Method: FindNoSyllablesAndNotProperNouns</span>
<span style="color: #aaaaaa; font-style: italic"># Purpose: Find words without syllable counts, that aren&#39;t proper nouns</span>
<span style="color: #aaaaaa; font-style: italic"># Parameters: none.</span>
<span style="color: #0000aa">def</span> <span style="color: #00aa00">FindNoSyllablesAndNotProperNouns</span>():
    <span style="color: #aaaaaa; font-style: italic"># Open the syllable wordlist, and the master wordlist</span>
    s_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;./webS&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)
    w_fd = <span style="color: #00aaaa">open</span>(<span style="color: #aa5500">&quot;/usr/share/dict/words&quot;</span>, <span style="color: #aa5500">&quot;r&quot;</span>)

    <span style="color: #aaaaaa; font-style: italic"># Keep track of the number of words without syllable counts that are</span>
    <span style="color: #aaaaaa; font-style: italic"># not proper nouns.</span>
    count = <span style="color: #009999">0</span>

    <span style="color: #aaaaaa; font-style: italic"># Enumerate the wordlist.</span>
    <span style="color: #0000aa">for</span> i,line <span style="color: #0000aa">in</span> <span style="color: #00aaaa">enumerate</span>(s_fd):
        <span style="color: #aaaaaa; font-style: italic"># Get the word and it&#39;s syllable count</span>
        line = line.split(<span style="color: #aa5500">&quot;,&quot;</span>)
        word = line[<span style="color: #009999">0</span>].strip()
        sylls = <span style="color: #00aaaa">int</span>(line[<span style="color: #009999">1</span>])

        <span style="color: #aaaaaa; font-style: italic"># Get the word from the master wordlist</span>
        m_word = w_fd.readline().strip()

        <span style="color: #aaaaaa; font-style: italic"># If the word has no syllable count, see if it&#39;s a proper noun</span>
        <span style="color: #0000aa">if</span> (sylls == -<span style="color: #009999">1</span>):
            <span style="color: #0000aa">if</span> (<span style="color: #0000aa">not</span> m_word[<span style="color: #009999">0</span>].isupper()):
                <span style="color: #00aaaa">print</span>(word)
                count += <span style="color: #009999">1</span>

    <span style="color: #aaaaaa; font-style: italic"># Close files</span>
    s_fd.close()
    w_fd.close()

    <span style="color: #aaaaaa; font-style: italic"># Print count for user</span>
    <span style="color: #00aaaa">print</span>(count,<span style="color: #aa5500">&quot;records found.&quot;</span>)
</pre></td></tr></table></div>

<p>85,524 left. Just by checking for proper nouns alone, I ruled out 16,937 words that, of course, will not be in a dictionary. What about the rest? Many are words with prefixes and suffixes whose roots exist in the dictionary, but that do not exist in their present form. Take "absenteeship", for example. Others are foreign words like "haori", which is a traditional Japanese jacket. "Pharyngotonsillitis" is a medical condition. Are these words? Yes. Am I concerned about testing my syllable counter against them? No. Whether it counts seven syllables in pharyngotonsillitis or not, I will sleep just fine at night.</p>

<br />

<!-- Conclusion -->
<p>As most projects do, this one started small--and then it got out of hand. <a href="/projects.html#proofer">Proofer</a> has not gotten any faster, but now I have a syllable dictionary to test the syllable count method so that I can then write a new method optimized for speed and memory use. Maybe, at the end of all this, Proofer will be a bit faster. That's ... something. Right?</p>

<p>For those of you who stuck around, you can download the syllable dictionary <a href="https://gist.github.com/zacjszewczyk/b47c2307ca3d5a36c45f240cac54ea3d">here</a>.

</div>
                </article></section></main><footer style="max-width:65em;margin:0 auto;margin-bottom:100px"><p>Follow me on <a href="http://twitter.com/zacjszewczyk">Twitter</a>, <a href="https://www.instagram.com/zacjszewczyk/">Instagram</a>, or subscribe to my <a href="/rss.xml">RSS</a> feed.<p>漏 2012-2019 Zachary Szewczyk.<br>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/"rel="license">Creative Commons Attribution 4.0 International License</a>.</footer><link href="../assets/main.css"rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-138585845-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-138585845-1")</script>