<!doctypehtml><html lang="en"><meta charset="UTF-8"><meta content="I spent a lot of time on [First Crack](/projects.html#firstCrack) this month. Writing [last month's](First Crack Release Notes 1119.txt) release notes pushed me to stop dragging my feet, and I made some great progress." name="description"><meta content="Zac Szewczyk, Zachary Szewczyk, Zac J. Szewczyk, Szewczyk, zacjszewczyk" name="keywords"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="Zac Szewczyk" name="application-name"><meta content="no-referrer" name="referrer"><meta content="#518341" name="theme-color"><meta content="index, follow" name="robots"><meta content="favicon.ico" property="og:image"><meta content="First Crack Release Notes, December 2019 - " property="og:title"><meta content="Zac Szewczyk" property="og:site_name"><meta content="Zac Szewczyk" property="og:article:author"><meta content="https://zacs.site/" property="og:see_also"><link href="/assets/manifest.json" rel="manifest"><link href="https://zacs.site/rss.xml" rel="alternate" type="application/rss+xml" title="RSS Feed for Zac Szewczyk's Blog"><link href="/assets/favicon.ico" rel="shortcut icon" type="image/ico" size="16x16"><link href="/assets/favicon_192.ico" rel="shortcut icon" type="image/ico" size="192x192"><link href="/assets/favicon_512.ico" rel="shortcut icon" type="image/ico" size="512x512"><title>First Crack Release Notes, December 2019 -  Zac Szewczyk</title><!-- SHEETS --><body id="post" style="opacity:.8;background-color:#f6f6f6;font-family:sans-serif;font-size:13pt;line-height:200%"><header style="text-align:center;font-size:150%;max-width:75em;margin:0 auto"><!--BLOCK HEADER--></header><nav style="display:grid;text-align:center;margin:10% 5%;font-size:15pt;line-height:200%"><a href="../index.html" id="home_link">Home</a> <a href="../blog.html" id="blog_link">Blog</a> <a href="../explore.html" id="explore_link">Explore</a> <a href="/rss.xml" id="rss_link">RSS</a> <a href="../archives.html" id="archives_link" rel="prefetch">Post Archives</a> <a href="../projects.html" id="projects_link">Projects</a> <a href="disclaimers.html" id="disclaimers_link">Disclaimers</a></nav><main style="max-width:65em;margin:0 auto;margin-bottom:100px"><section id="content_section">
<article>
<h2 style="text-align:center;">
<a href="first-crack-release-notes-1219.html" class="original">First Crack Release Notes, December 2019</a>
                    </h2>
<time datetime="2019-12-31" pubdate="pubdate">By <link rel="author">Zac Szewczyk</link> on <a href="2019.html">2019</a>/<a href="2019-12.html">12</a>/31 06:41:36 EST</time>
<p>I spent a lot of time on <a href="/projects.html#firstCrack">First Crack</a> this month. Writing <a href="https://zacs.site/blog/first-crack-release-notes-1119.html">last month&#8217;s</a> release notes pushed me to stop dragging my feet, and I made some great progress. </p>

<h2 class="headers" id="DecemberActivity">December Activity<span>&nbsp;<a href="#DecemberActivity">#</a></span></h2>

<p>I talked about the problems multi-threading caused in <a href="https://zacs.site/blog/first-crack-release-notes-1119.html">last month&#8217;s post</a>, and my band-aid fix: instantiating a Markdown parser for each file. This bumped First Crack&#8217;s sub-second runtime up over the one second mark, and just felt lazy, so I set out to fix it in early December.</p>

<p>I first binned the files by year, then fed each bin to its own core. First Crack rebuilt HTML files as needed, sorted them by time, then went back over them to extract their title and content for the blog and archives pages. I chose this approach because I had to build those index pages from newest to oldest, and it allowed the engine to do most of the file operations&#160;&#8212;&#160;and all the Markdown parsing&#160;&#8212;&#160;up front, as fast as possible, and without regards to order. This rewrite ended up running <em>slower</em> than the original, though, and had its fair share of strange bugs<sup id="fnref1"><a href="#fn1" rel="footnote">1</a></sup>. I played around with it for the rest of the weekend, but the rewrite I had such hope for just never made the cut.</p>

<p>I did find a few ways to improve performance during the course of that rewrite, though, which ended up cutting runtime by up to <em>half</em>. Check out the GIF below, via <a href="https://github.com/faressoft/terminalizer/blob/master/README.md">Terminalizer</a>, which shows the latest version of First Crack clearing and then building my entire site ten times:</p>

<div class='image'><img src='/assets/Images/system/runtime.gif' alt='First Crack runtime, 10 runs' title='First Crack runtime, 10 runs' loading='lazy' /></div>

<p>First Crack rebuilds the entire site in as much as 0.81 seconds, and as little as 0.64&#160;&#8212;&#160;its best yet. De-duplicating work across a few methods helped, but for the most part that massive speed boost came from slashing I/O operations. To build the <a href="/archives.html">Post Archives</a> page and <a href="/rss.xml">RSS feed</a>, the engine used to sort every file, read a certain number of paragraphs based on article type, open the target, append that content, close both, and then repeat until it got through every post. It now does this in batches, which got rid of almost 1,000 file operations on <code>archives.html</code> and <code>rss.xml</code> each. This had the greatest impact on First Crack&#8217;s runtime in December, by far.</p>

<br />

<p>Although <a href="https://jeffhuang.com/designed_to_last/">Jeff Huang&#8217;s recent push for developers to write well-structured HTML to help novies learn</a> did give me pause, I also gave up on &#8220;pretty printing&#8221; in December. Minifying the template alone shrank its file size by almost 25%. Applying this to the rest of the build process shaved almost 1KB off the average file size. As a result, First Crack takes less time to build smaller files that then load faster for you&#160;&#8212;&#160;a win all around. All DOM inspection tools reformat HTML anyway, so I&#8217;ll take the performance boost with no real downside.</p>

<h2 class="headers" id="FeatureRoadmap">Feature Roadmap<span>&nbsp;<a href="#FeatureRoadmap">#</a></span></h2>

<p>Going forward, I plan to focus on these (mostly minor) features.</p>

<h3 class="headers" id="ReleaseMarkdownParser">Release Markdown Parser<span>&nbsp;<a href="#ReleaseMarkdownParser">#</a></span></h3>

<p>I still want to release my Markdown parser as its own project. I still have some bugs to work out, though, I want to go public with greater coverage of the spec, and I would like to add the ability to parse multi-line strings and entire files at once.</p>

<h3 class="headers" id="PublishImplementationofMarkdownSpec">Publish Implementation of Markdown Spec<span>&nbsp;<a href="#PublishImplementationofMarkdownSpec">#</a></span></h3>

<p>I still want to outline the peculiarities of my implementation of the Markdown spec. This would cover weird edge cases for the most part, but documenting these shortfalls would still have value so that those who use my engine will have some sort of explanation for why their article looks weird, and so that I may one day fix them. I made some progress here this month, but not enough for a finished product.</p>

<h3 class="headers" id="ImproveDocumentation">Improve Documentation<span>&nbsp;<a href="#ImproveDocumentation">#</a></span></h3>

<p>As always, I could do more here. Again, a few of the ways I think I can improve the README:</p>

<ul>
    <li>Performance graphs of First Crack&#8217;s back-end performance versus other, similar engines. At less than two seconds to build a website of over one thousand pages, I want to highlight this.</li>
<li>Performance graphs of the web pages First Crack builds versus the pages common content management systems build.</li>
<li>Screenshots. This site is a live demo of the engine, but I like the idea of having a few pictures in there, too.</li>
</ul>
<p>As always, I look forward to the work ahead.</p>

<p id='fn1'><a class='fn' title='return to article' href='#fnref1'>&#x21a9;</a>&nbsp;How about this one: if the beta engine creates a new Markdown purser for each file, a seemingly random subset of 2019 posts do not get parsed. Instead, the original Markdown appears in the output HTML files as if copied straight from the source. If the engine creates a new parser for each month, more files go unparsed, this time from other years as well. If each core gets one parser to handle the entire year, the parser skips over almost 10% of the source files. Weird.</p>

</div>
                </article></section></main><footer style="max-width:65em;margin:0 auto;margin-bottom:100px"><p>Follow me on <a href="http://twitter.com/zacjszewczyk">Twitter</a>, <a href="https://www.instagram.com/zacjszewczyk/">Instagram</a>, or subscribe to my <a href="/rss.xml">RSS</a> feed.</p><p>Â© 2012-2020 Zachary Szewczyk.<br>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>.</p></footer><link href="../assets/main.css" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-138585845-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-138585845-1")</script><html>