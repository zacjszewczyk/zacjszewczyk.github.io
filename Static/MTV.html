<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>FMTV RV Builder</title>
        <meta name="description" content="FMTV RV Builder">
        <meta name="author" content="Zac Szewczyk">
    </head>
    <style type="text/css">
        /* Debug */
        section, main
        {
            border: 1px solid black;
        }
        #angled
        {
            position: absolute;
            background-color: transparent;

            border-style: solid;
            border-color: #807F17 transparent transparent transparent;
        }
        body
        {
            margin: 0;
            padding: 0;
        }
        #box
        {
            position: absolute;
            left: 317px;
            top: 93px;
            height: 229px;
            width: 469px;
            z-index: 1;
            background-color: #807F17;
        }
        #container
        {
            position: absolute;
            background-color: #807F17;
        }
        #controls div
        {
            margin: 1em 0;
        }
        #images
        {
            position: relative;
            padding: 10em 0 0 3em;
            height: 325px;
        }
        #images img
        {
            opacity: .7;
            position: absolute;
            width: 46em;
        }
        label
        {
            font-size: 150%;
        }
        main
        {
            width: 70em;
            margin: 0 auto;
        }
        #M1078
        {
            width: 42em !important;
        }
        #M1083
        {
            display: none;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript">
    $( document ).ready(function() {
        // Variables
        var position;
        var dimensions;

        // Functions
        function adjustSize() {
            var field = document.getElementById("box_length_field");
            if (field.value >= 12 && field.value <= 14) {
                $("#container").hide();
                $("#box").show().width(field.value*33.5);
            }
            else if (field.value > 14) {
                if ($("#M1078").css("display") == "block") {
                    $("#box").show().width(14*33.5);
                    angledSize();
                }
                else {
                    if (field.value <= 16) {
                        $("#box").show().width(field.value*33.5);
                        $("#container").hide();
                    }
                    else {                        
                        $("#box").show().width(16*33.5);
                        angledSize();
                    }
                }
            }
        }
        function angledSize() {
            var offset = 0;
            offset = getChassis();

            var field = document.getElementById("box_length_field");

            dimensions = {width : parseInt($("#box").css("width")), height : parseInt($("#box").css("height")) };
                    
            $("#container").show();
            $("#container").css("height", 229-(0.839*(field.value-offset)*35.5));
            $("#container").css("width", (field.value-offset)*35.5);
            $("#angled").css("top", dimensions.height-(0.839*(field.value-offset)*35.5));
            $("#container").css("left", dimensions.width);
            $("#angled").css("border-width", (0.839*(field.value-offset)*35.5).toString()+"px "+((field.value-offset)*35.5).toString()+"px 0 0");
        }
        function getChassis() {
            if ($(":radio")[0].checked == true) {
                return 14;
            } else {
                return 16;
            }
        }

        // End functions

        // Chassis selector
        $("#M1083_button").click(function() {
            $("#M1078").hide();
            $("#M1083").show();
            $("#box_length_field").attr("max", 23);
            adjustSize();
        })
        $("#M1078_button").click(function() {
            $("#M1083").hide();
            $("#M1078").show();
            if (document.getElementById("box_length_field").value > 21) {
                document.getElementById("box_length_field").value = 21;
            }
            $("#box_length_field").attr("max", 21);
            adjustSize();
        })

        // Box length checkboxes
        $(".box_length_checkbox").click(function() {
            document.getElementById("box_length_field").value = this.value;
            adjustSize()
            $(".box_length_checkbox").prop("checked", false);
            $(this).prop("checked", true);
        });

        // Box length field
        $("#box_length_field").on('input', function() {
            $(".box_length_checkbox").prop("checked", false);
            if ((getChassis() == 14 && this.value <= 21) || (getChassis() == 16 && this.value <= 23)) {
                adjustSize();
            }
        });

        // Raised roof checkbox
        $("#raised_roof_checkbox").click(function() {

        });
    });
    </script>
    <body>
        <main>
            <section id="images">
                <div id="box">
                    <div id="topper"></div>
                    <div id="container">
                        <div id="filler"></div>
                        <div id="angled"></div>
                    </div>
                </div>
                <img id="M1078" src="Static/Images/M1078_new.png" />
                <img id="M1083" src="Static/Images/M1083_new.png" />
            </section>
            <section id="controls">
                <div>
                    <input type="radio" id="M1078_button" name="FMTV" value="14" checked>
                    <label for="M1078_button">M1078</label>
                    <input type="radio" id="M1083_button" name="FMTV" value="16">
                    <label for="M1083_button">M1083</label>
                </div>
                <div>
                    <input type="checkbox" class="box_length_checkbox" id="14ft_box_button" name="box" value="14" checked>
                    <label for="14ft_box_button">14' Box</label>
                    <input type="checkbox" class="box_length_checkbox" id="16ft_box_button" name="box" value="16">
                    <label for="16ft_box_button">16' Box</label>
                </div>
                <div>
                    <label for="box_length_field">Box length (ft)</label>
                    <input type="number" name="box_length_field" id="box_length_field" max="21" />
                </div>
                <div>
                    <label for="raised_roof_checkbox">Raised roof: </label>
                    <input type="checkbox" id="raised_roof_checkbox" />
                </div>
            </section>
        </main>
    </body>
</html>